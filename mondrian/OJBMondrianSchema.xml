<!--
    
    Unless explicitly acquired and licensed from Licensor under another license, the contents of
    this file are subject to the Reciprocal Public License ("RPL") Version 1.5, or subsequent
    versions as allowed by the RPL, and You may not copy or use this file in either source code
    or executable form, except in compliance with the terms and conditions of the RPL
    All software distributed under the RPL is provided strictly on an "AS IS" basis, WITHOUT
    WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, AND LICENSOR HEREBY DISCLAIMS ALL SUCH
    WARRANTIES, INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
    PARTICULAR PURPOSE, QUIET ENJOYMENT, OR NON-INFRINGEMENT. See the RPL for specific language
    governing rights and limitations under the RPL.

    http://opensource.org/licenses/RPL-1.5

    Copyright 2012-2015 Open Justice Broker Consortium

    -->
<Schema name="OJBC Analytics">
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="County">
		<Hierarchy name="County" visible="true" hasAll="true" allMemberName="All Counties" allMemberCaption="All Counties" primaryKey="CountyID">
			<Table name="County"/>
			<Level name="County" visible="true" table="County" column="CountyName" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Agency">
		<Hierarchy name="Agency" visible="true" hasAll="true" allMemberName="All Agencies" allMemberCaption="All Agencies" primaryKey="AgencyID">
			<Table name="Agency"/>
			<Level name="Agency" visible="true" table="Agency" column="AgencyName" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Race">
		<Hierarchy name="Race" visible="true" hasAll="true" primaryKey="PersonRaceID" caption="Race">
			<Table name="PersonRace"/>
			<Level name="Race" visible="true" table="PersonRace" column="PersonRaceDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Drug">
		<Hierarchy name="Drug" visible="true" hasAll="true" primaryKey="InvolvedDrugID" caption="Drug">
			<Table name="InvolvedDrug"/>
			<Level name="Drug" visible="true" table="InvolvedDrug" column="InvolvedDrugDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Offense Type" caption="Type of Offense">
        <Hierarchy name="OffenseType" visible="true" hasAll="true" allMemberName="All Offenses" primaryKey="OffenseTypeID" caption="Offense Type">
            <Table name="OffenseType"/>
            <Level name="OffenseType" visible="true" column="OffenseTypeID" nameColumn="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
        <Hierarchy name="Drug Offense" visible="true" hasAll="true" allMemberName="All Offenses" primaryKey="OffenseTypeID" caption="Drug Offense">
            <Table name="OffenseType"/>
            <Level name="DrugOffense" visible="true" column="IsDrugOffense" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="Is Drug Offense"/>
            <Level name="OffenseType" visible="true" column="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
        <Hierarchy name="Offense Severity" visible="true" hasAll="true" allMemberName="All Severities" allMemberCaption="All Severities" primaryKey="OffenseTypeID" caption="Offense Severity">
            <Table name="OffenseType"/>
            <Level name="OffenseSeverity" visible="true" column="OffenseSeverity" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Severity of Offense"/>
            <Level name="OffenseType" visible="true" column="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
        <Hierarchy name="Ready Cash Offenses" visible="true" hasAll="true" allMemberName="All Offenses" allMemberCaption="All Offenses" primaryKey="OffenseTypeID" caption="Ready Cash Offenses">
            <View alias="ReadyCashOffenseType">
			    <SQL dialect="mysql">
			        <![CDATA[select OffenseTypeID, OffenseDescription, ReadyCashOffenseCategoryDescription from OffenseType, ReadyCashOffenseCategory
                    where OffenseType.ReadyCashOffenseCategoryID=ReadyCashOffenseCategory.ReadyCashOffenseCategoryID]]>
                </SQL>
            </View>
            <Level name="ReadyCashOffenseCategory" visible="true" column="ReadyCashOffenseCategoryDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Ready Cash Offense Category"/>
            <Level name="OffenseType" visible="true" column="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
	</Dimension>
	<!-- We need these three dimensions separated out because of http://jira.pentaho.com/browse/MONDRIAN-1032 -->
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="OffenseType_sep" caption="Type of Offense">
        <Hierarchy name="OffenseType" visible="true" hasAll="true" allMemberName="All Offenses" primaryKey="OffenseTypeID" caption="Offense Type">
            <Table name="OffenseType"/>
            <Level name="OffenseType" visible="true" column="OffenseTypeID" nameColumn="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
    </Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="DrugOffense_sep" caption="Drug Offense">
        <Hierarchy name="Drug Offense" visible="true" hasAll="true" allMemberName="All Offenses" primaryKey="OffenseTypeID" caption="Drug Offense">
            <Table name="OffenseType"/>
            <Level name="DrugOffense" visible="true" column="IsDrugOffense" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="Is Drug Offense"/>
            <Level name="OffenseType" visible="true" column="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
    </Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="OffenseSeverity_sep" caption="Offense Severity">
        <Hierarchy name="Offense Severity" visible="true" hasAll="true" allMemberName="All Severities" allMemberCaption="All Severities" primaryKey="OffenseTypeID" caption="Offense Severity">
            <Table name="OffenseType"/>
            <Level name="OffenseSeverity" visible="true" column="OffenseSeverity" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Severity of Offense"/>
            <Level name="OffenseType" visible="true" column="OffenseDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Type of Offense"/>
        </Hierarchy>
	</Dimension>
	<!-- End of workaround for http://jira.pentaho.com/browse/MONDRIAN-1032 -->
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Sex">
		<Hierarchy name="PersonSex" visible="true" hasAll="true" allMemberName="All Sexes" allMemberCaption="All Sexes" caption="Sex">
			<Table name="PersonSex"/>
			<Level name="PersonSex" visible="true" table="PersonSex" column="PersonSexID" nameColumn="PersonSexDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Disposition">
		<Hierarchy name="Disposition" visible="true" hasAll="true" primaryKey="DispositionID">
			<Table name="Disposition"/>
			<Level name="Conviction" visible="true" table="Disposition" column="IsConviction" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="Convicted?">
				<NameExpression>
					<SQL dialect="mysql">
            <![CDATA[IF(IsConviction='Y',"Convicted", "Not Convicted")]]>
					</SQL>
				</NameExpression>
			</Level>
			<Level name="Disposition" visible="true" table="Disposition" column="DispositionDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Age">
		<Hierarchy name="PersonAge" visible="true" hasAll="true" primaryKey="PersonAgeID" primaryKeyTable="PersonAge" caption="Age">
			<Join leftKey="PersonAgeRangeID" rightKey="PersonAgeRangeID">
				<Table name="PersonAge"/>
				<Table name="PersonAgeRange"/>
			</Join>
			<Level name="AgeRange" visible="true" column="AgeRange5" table="PersonAgeRange" ordinalColumn="AgeRange5Sort" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
			<Level name="AgeYears" visible="true" column="AgeInYears" table="PersonAge" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Age Range">
		<Hierarchy name="AgeRange" visible="true" hasAll="true" allMemberName="All Ranges" allMemberCaption="All Ranges" primaryKey="PersonAgeRangeID" caption="Age Range">
			<Table name="PersonAgeRange"/>
			<Level name="Age Range" visible="true" table="PersonAgeRange" column="AgeRange5" ordinalColumn="AgeRange5Sort" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Risk Score">
		<Hierarchy name="RiskScore" visible="true" hasAll="true" allMemberName="All Risk Scores" allMemberCaption="All Risk Scores" primaryKey="RiskScoreID" caption="Risk Score">
			<Table name="RiskScore"/>
			<Level name="Risk Score" visible="true" table="RiskScore" column="RiskScoreDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Pretrial Service">
		<Hierarchy name="PretrialService" visible="true" hasAll="true" allMemberName="All Pretrial Services" allMemberCaption="All Pretrial Services" primaryKey="PretrialServiceID" caption="Pretrial Service">
			<Table name="PretrialService"/>
			<Level name="Pretrial Service Participant" visible="true" table="PretrialService" column="IsParticipant" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Participant?"/>
			<Level name="Pretrial Service" visible="true" table="PretrialService" column="PretrialServiceDescription" ordinalColumn="PretrialServiceID" type="String" uniqueMembers="true" levelType="Regular"
				hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="YesNoIndicator">
		<Hierarchy name="YesNoIndicator" visible="true" hasAll="true" allMemberName="All Options" allMemberCaption="All Options" primaryKey="YesNoID" caption="Yes/No">
			<Table name="YesNo"/>
			<Level name="YesNoIndicator" visible="true" table="YesNo" column="YesNoDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Incident Type">
		<Hierarchy name="IncidentType" visible="true" hasAll="true" allMemberName="All Types" allMemberCaption="All Types" primaryKey="IncidentTypeID" caption="Incident Type">
			<Table name="IncidentType"/>
			<Level name="IncidentType" visible="true" table="IncidentType" column="IncidentTypeDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
        <Hierarchy name="Incident Category" visible="true" hasAll="true" allMemberName="All Categories" allMemberCaption="All Categories" primaryKey="IncidentTypeID" caption="Incident Category">
            <View alias="IncidentTypeWithCategory">
			    <SQL dialect="mysql">
			        <![CDATA[select IncidentTypeID, IncidentTypeDescription, IncidentCategoryDescription from IncidentType, IncidentCategory
                    where IncidentType.IncidentCategoryID=IncidentCategory.IncidentCategoryID]]>
                </SQL>
            </View>
            <Level name="IncidentCategory" visible="true" column="IncidentCategoryDescription" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Incident Category"/>
			<Level name="IncidentType" visible="true" column="IncidentTypeDescription" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
        </Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Time Of Day">
		<Hierarchy name="Time" visible="true" hasAll="true" allMemberName="All Times" allMemberCaption="All Times" primaryKey="TimeID" caption="Time Of Day">
			<Table name="Time"/>
			<Level name="Hour" visible="true" table="Time" column="Hour" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="TimeDimension" visible="true" highCardinality="false" name="Date">
		<Hierarchy name="DateYMD" visible="true" hasAll="true" primaryKey="DateID" caption="Year/Month/Day" allMemberName="All Years" allMemberCaption="All Years" >
			<Table name="Date"/>
			<Level name="Year" visible="true" table="Date" column="YearLabel" type="String" uniqueMembers="false" levelType="TimeYears" hideMemberIf="Never"/>
			<Level name="Quarter" visible="true" table="Date" column="CalendarQuarter" type="String" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never"/>
			<Level name="Month" visible="true" column="FullMonth" ordinalColumn="Month" type="String" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never"/>
			<Level name="Day" visible="true" column="Day" type="String" uniqueMembers="false" levelType="TimeDays" hideMemberIf="Never"/>
		</Hierarchy>
		<Hierarchy name="CalDate" visible="true" hasAll="true" primaryKey="DateID" caption="Calendar Date">
			<Table name="Date"/>
			<Level name="Date" visible="true" column="CalendarDate" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never"/>
		</Hierarchy>
		<Hierarchy name="Day of Week" visible="true" hasAll="true" primaryKey="DateID" caption="Day of Week">
			<Table name="Date"/>
			<Level name="Day of Week" visible="true" column="DayOfWeek" ordinalColumn="DayOfWeekSort" type="String" uniqueMembers="false" levelType="TimeDays" hideMemberIf="Never"/>
		</Hierarchy>
	</Dimension>
	<Dimension type="StandardDimension" visible="true" highCardinality="false" name="Year">
	    <Hierarchy name="Year" viaible="true" hasAll="true" primaryKey="YearID">
	        <View alias="Year">
	            <SQL dialect="mysql">
	            <![CDATA[select distinct Year as YearID, Year as YearLabel from Date]]>
	            </SQL>
	        </View>
			<Level name="Year" visible="true" table="Year" column="YearLabel" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
	    </Hierarchy>
	</Dimension>
	<Cube name="Population" visible="false" enabled="true">
		<Table name="Population"/>
		<DimensionUsage source="Year" name="Year" visible="true" foreignKey="Year" highCardinality="false"/>
		<DimensionUsage source="County" name="County" visible="true" foreignKey="CountyID" highCardinality="false"/>
		<DimensionUsage source="Race" name="Race" visible="true" foreignKey="PersonRaceID" highCardinality="false"/>
		<DimensionUsage source="Sex" name="Sex" visible="true" foreignKey="PersonSexID" highCardinality="false"/>
		<DimensionUsage source="Age Range" name="Age Range" visible="true" foreignKey="PersonAgeRangeID" highCardinality="false"/>
		<Measure name="PopulationCount" column="PopulationCount" datatype="Integer" aggregator="sum" caption="Population Count" visible="true"/>
	</Cube>
	<Cube name="CrimeCount" visible="false" enabled="true">
		<View alias="CrimeCount">
			<SQL dialect="mysql">
        <![CDATA[select count(Charge.ArrestID) as ArrestCount, ArresteeRaceID, ArresteeSexID, PersonAgeRange.PersonAgeRangeID, CountyID, ArrestOffenseTypeID, Year, InvolvedDrugID
            from Arrest, PersonAge, PersonAgeRange, Charge, Date
            where Arrest.ArresteeAgeID=PersonAge.PersonAgeID and PersonAge.PersonAgeRangeID=PersonAgeRange.PersonAgeRangeID and Arrest.ArrestID=Charge.ArrestID
                and Arrest.DateID=Date.DateID
            group by ArresteeRaceID, ArresteeSexID, PersonAgeRange.PersonAgeRangeID, CountyID, ArrestOffenseTypeID, Year]]>
			</SQL>
		</View>
		<DimensionUsage source="Year" name="Year" visible="true" foreignKey="Year" highCardinality="false"/>
		<DimensionUsage source="County" name="County" visible="true" foreignKey="CountyID" highCardinality="false"/>
		<DimensionUsage source="Race" name="Race" visible="true" foreignKey="ArresteeRaceID" highCardinality="false"/>
		<DimensionUsage source="Sex" name="Sex" visible="true" foreignKey="ArresteeSexID" highCardinality="false"/>
		<DimensionUsage source="Age Range" name="Age Range" visible="true" foreignKey="PersonAgeRangeID" highCardinality="false"/>
		<DimensionUsage source="Drug" name="Drug" visible="true" foreignKey="InvolvedDrugID" highCardinality="false"/>
		<DimensionUsage source="Offense Type" name="OffenseType_sep" visible="true" foreignKey="ArrestOffenseTypeID" highCardinality="false"/>
		<DimensionUsage source="Offense Type" name="DrugOffense_sep" visible="true" foreignKey="ArrestOffenseTypeID" highCardinality="false"/>
		<DimensionUsage source="Offense Type" name="OffenseSeverity_sep" visible="true" foreignKey="ArrestOffenseTypeID" highCardinality="false"/>
		<Measure name="ArrestCount" column="ArrestCount" datatype="Integer" aggregator="sum" caption="Arrest Count" visible="true"/>
	</Cube>
	<Cube name="ArrestCharge" caption="Arrest Charge" visible="true" cache="true" enabled="true">
	
		<View alias="ArrestChargeRecidivism">
			<SQL dialect="mysql">
        <![CDATA[
		select pa.ArrestID as ArrestID,
    pa.DateID,
    pa.TimeID,
    pa.CountyID,
    pa.ArresteeAgeID,
    pa.ArresteeSexID,
    pa.ArresteeRaceID,
    pa.ArrestingAgencyID,
    pa.ViolatedConditionsOfRelease,
    datediff(sad.CalendarDate, pad.CalendarDate) as DaysBetweenArrests,
    if(datediff(sad.CalendarDate, pad.CalendarDate) <= 180, 1, 0) as SixMonthRearrest,
    if(datediff(sad.CalendarDate, pad.CalendarDate) <= 365, 1, 0) as OneYearRearrest,
    if(datediff(sad.CalendarDate, pad.CalendarDate) <= 730, 1, 0) as TwoYearRearrest,
    if(pc.DispositionID=1 and sc.DispositionID=1, datediff(scd.CalendarDate, pcd.CalendarDate), null) as DaysBetweenConvictions,
    if(if(pc.DispositionID=1 and sc.DispositionID=1, datediff(scd.CalendarDate, pcd.CalendarDate), null) <= 365, 1, 0) as OneYearReconviction,
    if(if(pc.DispositionID=1 and sc.DispositionID=1, datediff(scd.CalendarDate, pcd.CalendarDate), null) <= 730, 1, 0) as TwoYearReconviction,
    pc.ChargeID,
    pc.ArrestOffenseTypeID,
    pc.DispositionID as PriorDispositionID,
    pc.SentenceTermDays,
    pc.SentenceFineAmount,
    pc.InvolvedDrugID,
    pc.DispositionDateID,
    sc.DispositionID as SubsequentDispositionID,
    psp.PretrialServiceID,
    psp.AssessedNeedID,
    psp.RiskScoreID
    from (((Arrest as pa inner join Date as pad on pa.DateID=pad.DateID) inner join
            (Charge as pc inner join Date as pcd on pc.DispositionDateID=pcd.DateID) on pa.ArrestID=pc.ArrestID) left join
          ((Arrest as sa inner join Date as sad on sa.DateID=sad.DateID) left join
            (
                (select ArrestID, min(DispositionDateID) as DispositionDateID, DispositionID from Charge where DispositionID=1 group by ArrestID) as sc inner join
                    Date as scd on sc.DispositionDateID=scd.DateID) on sa.ArrestID=sc.ArrestID) on pa.SubsequentArrestID=sa.ArrestID)
            left join PretrialServiceParticipation as psp on pa.ArrestID=psp.ArrestID]]>
			</SQL>
		</View>
		
		<DimensionUsage source="County" name="County" visible="true" foreignKey="CountyID" highCardinality="false"/>
		<DimensionUsage source="Agency" name="Agency" visible="true" foreignKey="ArrestingAgencyID" highCardinality="false"/>
		<DimensionUsage source="Race" name="Race" visible="true" foreignKey="ArresteeRaceID" highCardinality="false"/>
		<DimensionUsage source="Drug" name="Drug" visible="true" foreignKey="InvolvedDrugID" highCardinality="false"/>
		<DimensionUsage source="Offense Type" name="Offense Type" visible="true" foreignKey="ArrestOffenseTypeID" highCardinality="false"/>
		<DimensionUsage source="Sex" name="Sex" visible="true" foreignKey="ArresteeSexID" highCardinality="false"/>
		<DimensionUsage source="Disposition" name="Disposition" visible="true" foreignKey="PriorDispositionID" highCardinality="false"/>
		<DimensionUsage source="Risk Score" name="Risk Score" visible="true" foreignKey="RiskScoreID" highCardinality="false"/>
		<DimensionUsage source="Pretrial Service" name="Pretrial Service" visible="true" foreignKey="PretrialServiceID" highCardinality="false"/>
		<DimensionUsage source="Age" name="Age" caption="Age" visible="true" foreignKey="ArresteeAgeID" highCardinality="false"/>
		<DimensionUsage source="YesNoIndicator" name="ViolatedConditionsOfRelease" caption="Violated Release Conditions" visible="true" foreignKey="ViolatedConditionsOfRelease"
			highCardinality="false"/>
		<DimensionUsage source="Date" name="Date" visible="true" foreignKey="DateID" highCardinality="false"/>
		<DimensionUsage source="Date" name="Disposition Date" visible="true" foreignKey="DispositionDateID" highCardinality="false" caption="Disposition Date"/>
		<DimensionUsage source="Time Of Day" name="Time Of Day" visible="true" foreignKey="TimeID" highCardinality="false"/>
		<Measure name="ArrestChargeCount" column="ChargeID" datatype="Integer" aggregator="distinct-count" caption="Arrest Charge Count" visible="true"/>
		<Measure name="SixMonthRearrestCount" column="SixMonthRearrest" datatype="Integer" aggregator="sum" caption="Six Month Rearrest Count" visible="true"/>
		<Measure name="OneYearRearrestCount" column="OneYearRearrest" datatype="Integer" aggregator="sum" caption="One Year Rearrest Count" visible="true"/>
		<Measure name="TwoYearRearrestCount" column="TwoYearRearrest" datatype="Integer" aggregator="sum" caption="Two Year Rearrest Count" visible="true"/>
		<Measure name="OneYearReconvictionCount" column="OneYearReconviction" datatype="Integer" aggregator="sum" caption="One Year Reconviction Count" visible="true"/>
		<Measure name="TwoYearReconvictionCount" column="TwoYearReconviction" datatype="Integer" aggregator="sum" caption="Two Year Reconviction Count" visible="true"/>
		<Measure name="TotalSentenceTerm" column="SentenceTermDays" datatype="Numeric" aggregator="avg" caption="Sentence Term (Days)" visible="true"/>
		<Measure name="TotalFineAmount" column="SentenceFineAmount" datatype="Numeric" aggregator="avg" caption="Sentence Fine Amount" visible="true"/>
		<Measure name="DaysUntilSubsequentArrest" column="DaysBetweenArrests" datatype="Numeric" aggregator="distinct-count" caption="Days Until Next Arrest" visible="true"/>
		<CalculatedMember name="SixMonthRearrestRate" caption="Six Month Rearrest Rate" dimension="Measures">
			<Formula>[Measures].[SixMonthRearrestCount] / [Measures].[ArrestChargeCount]</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.0 %"/>
		</CalculatedMember>
		<CalculatedMember name="OneYearRearrestRate" caption="One Year Rearrest Rate" dimension="Measures">
			<Formula>[Measures].[OneYearRearrestCount] / [Measures].[ArrestChargeCount]</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.0 %"/>
		</CalculatedMember>
		<CalculatedMember name="TwoYearRearrestRate" caption="Two Year Rearrest Rate" dimension="Measures">
			<Formula>[Measures].[TwoYearRearrestCount] / [Measures].[ArrestChargeCount]</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.0 %"/>
		</CalculatedMember>
		<CalculatedMember name="OneYearReconvictionRate" caption="One Year Reconviction Rate" dimension="Measures">
			<Formula>[Measures].[OneYearReconvictionCount] / [Measures].[ArrestChargeCount]</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.0 %"/>
		</CalculatedMember>
		<CalculatedMember name="TwoYearReconvictionRate" caption="Two Year Reconviction Rate" dimension="Measures">
			<Formula>[Measures].[TwoYearReconvictionCount] / [Measures].[ArrestChargeCount]</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.0 %"/>
		</CalculatedMember>
	</Cube>
	<Cube name="Incident" caption="Incident" visible="true" cache="true" enabled="true">
		<Table name="Incident"/>
		<DimensionUsage source="Agency" name="Agency" visible="true" foreignKey="ReportingAgencyID" highCardinality="false"/>
		<DimensionUsage source="Incident Type" name="Incident Type" visible="true" foreignKey="IncidentTypeID" highCardinality="false"/>
		<DimensionUsage source="Date" name="Date" visible="true" foreignKey="DateID" highCardinality="false"/>
		<DimensionUsage source="Time Of Day" name="Time Of Day" visible="true" foreignKey="TimeID" highCardinality="false"/>
		<Measure name="IncidentCount" column="IncidentID" datatype="Integer" aggregator="distinct-count" caption="Incident Count" visible="true"/>
	</Cube>
	<Cube name="PretrialServicesParticipation" caption="Pretrial Services Participation" visible="true" cache="true" enabled="true">
		<View alias="PretrialServicesParticipation">
			<SQL dialect="mysql">
        <![CDATA[select PretrialServiceParticipationID, PretrialServiceParticipation.PretrialServiceID, ArresteeRaceID,
        ArresteeSexID, ArresteeAgeID, PretrialServiceParticipation.CountyID, IntakeDateID
        from PretrialServiceParticipation, Arrest
        where PretrialServiceParticipation.ArrestID=Arrest.ArrestID]]>
			</SQL>
		</View>
		<DimensionUsage source="Pretrial Service" name="Pretrial Service" visible="true" foreignKey="PretrialServiceID" highCardinality="false"/>
		<DimensionUsage source="Race" name="Race" visible="true" foreignKey="ArresteeRaceID" highCardinality="false"/>
		<DimensionUsage source="Sex" name="Sex" visible="true" foreignKey="ArresteeSexID" highCardinality="false"/>
		<DimensionUsage source="Age" name="Age" visible="true" foreignKey="ArresteeAgeID" highCardinality="false"/>
		<DimensionUsage source="County" name="County" visible="true" foreignKey="CountyID" highCardinality="false"/>
		<DimensionUsage source="Date" name="Intake Date" visible="true" foreignKey="IntakeDateID" highCardinality="false"/>
		<Measure name="PretrialServiceParticipantCount" column="PretrialServiceParticipationID" datatype="Integer" aggregator="distinct-count" caption="Pretrial Service Participant Count" visible="true"/>
	</Cube>
	<VirtualCube name="Crime Rates">
		<CubeUsages>
			<CubeUsage cubeName="Population" ignoreUnrelatedDimensions="true"/>
			<CubeUsage cubeName="CrimeCount" ignoreUnrelatedDimensions="true"/>
		</CubeUsages>
		<VirtualCubeDimension name="Year"/>
		<VirtualCubeDimension name="County"/>
		<VirtualCubeDimension name="Race"/>
		<VirtualCubeDimension name="Sex"/>
		<VirtualCubeDimension name="Age Range"/>
		<VirtualCubeDimension name="Drug"/>
		<VirtualCubeDimension name="OffenseType_sep"/>
		<VirtualCubeDimension name="DrugOffense_sep"/>
		<VirtualCubeDimension name="OffenseSeverity_sep"/>
		<VirtualCubeMeasure cubeName="Population" name="[Measures].[PopulationCount]"/>
		<VirtualCubeMeasure cubeName="CrimeCount" name="[Measures].[ArrestCount]"/>
		<CalculatedMember name="Crime Rate Per 1000" dimension="Measures">
			<Formula>(1000 * ValidMeasure([Measures].[ArrestCount])) / ValidMeasure([Measures].[PopulationCount])</Formula>
			<CalculatedMemberProperty name="FORMAT_STRING" value="#0.00"/>
		</CalculatedMember>
	</VirtualCube>
</Schema>

